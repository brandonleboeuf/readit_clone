{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useEffect, useState } from 'react';\nimport Link from 'next/link';\nimport Image from 'next/image';\nimport { useRouter } from 'next/router';\nimport Axios from 'axios';\nimport { useAuthState, useAuthDispatch } from '../context/auth';\nimport RedditLogo from '../images/reddit.svg';\n\nconst Navbar = () => {\n  const {\n    0: name,\n    1: setName\n  } = useState('');\n  const {\n    0: subs,\n    1: setSubs\n  } = useState([]);\n  const {\n    0: timer,\n    1: setTimer\n  } = useState(null);\n  const {\n    authenticated,\n    loading,\n    user\n  } = useAuthState();\n  const dispatch = useAuthDispatch();\n  const router = useRouter();\n\n  const logout = () => {\n    Axios.get('/auth/logout').then(() => {\n      dispatch('LOGOUT');\n      window.location.reload();\n    }).catch(err => console.log(err));\n  };\n\n  useEffect(() => {\n    if (name.trim() === '') {\n      setSubs([]);\n      return;\n    }\n\n    searchSubs();\n  }, [name]);\n\n  const searchSubs = async () => {\n    clearTimeout(timer);\n    setTimer(setTimeout(async () => {\n      try {\n        const {\n          data\n        } = await Axios.get(`/subs/search/${name}`);\n        setSubs(data);\n      } catch (err) {\n        console.log(err);\n      }\n    }, 250));\n  };\n\n  const goToSub = subName => {\n    router.push(`/r/${subName}`);\n    setName('');\n  };\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: \"fixed inset-x-0 top-0 z-10 flex items-center justify-between h-12 px-5 bg-white\",\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"flex items-center\",\n      children: [/*#__PURE__*/_jsx(Link, {\n        href: \"/\",\n        children: /*#__PURE__*/_jsx(\"a\", {\n          children: /*#__PURE__*/_jsx(RedditLogo, {\n            className: \"w-8 h-8 mr-2\"\n          })\n        })\n      }), /*#__PURE__*/_jsx(\"span\", {\n        className: \"hidden text-2xl font-semibold lg:block\",\n        children: /*#__PURE__*/_jsx(Link, {\n          href: \"/\",\n          children: \"readit\"\n        })\n      })]\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"max-w-full px-4 w-160\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"relative flex items-center bg-gray-100 border rounded hover:border-blue-500 hover:bg-white\",\n        children: [/*#__PURE__*/_jsx(\"i\", {\n          className: \"pl-4 pr-3 text-gray-500 fas fa-search\"\n        }), /*#__PURE__*/_jsx(\"input\", {\n          type: \"text\",\n          className: \"py-1 pr-3 bg-transparent rounded focus:outline-none\",\n          placeholder: \"Search\",\n          value: name,\n          onChange: e => setName(e.target.value),\n          onBlur: () => setTimeout(() => setName(''), 250)\n        }), name && /*#__PURE__*/_jsx(\"div\", {\n          className: \"absolute left-0 right-0 bg-white\",\n          style: {\n            top: '100%'\n          },\n          children: subs === null || subs === void 0 ? void 0 : subs.map(sub => /*#__PURE__*/_jsxs(\"div\", {\n            className: \"flex items-center px-4 py-3 cursor-pointer hover:bg-gray-200\",\n            onClick: () => goToSub(sub.name),\n            children: [/*#__PURE__*/_jsx(Image, {\n              src: sub.imageUrl,\n              alt: \"Sub\",\n              className: \"rounded-full\",\n              height: 8 * 16 / 4,\n              width: 8 * 16 / 4\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \"ml-4 text-sm\",\n              children: [/*#__PURE__*/_jsx(\"p\", {\n                className: \"font-medium\",\n                children: sub.name\n              }), /*#__PURE__*/_jsx(\"p\", {\n                className: \"text-gray-600\",\n                children: sub.title\n              })]\n            })]\n          }, sub.bannerUrl))\n        })]\n      })\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"flex\",\n      children: !loading && (authenticated ?\n      /*#__PURE__*/\n      // Show logout button\n      _jsxs(_Fragment, {\n        children: [/*#__PURE__*/_jsx(\"p\", {\n          className: \"hidden pt-2 pr-2 text-xs font-semibold lg:block\",\n          children: user.username\n        }), /*#__PURE__*/_jsx(\"button\", {\n          className: \"w-20 py-1 mr-5 leading-5 lg:w-32 hollow blue button\",\n          onClick: logout,\n          children: \"Log Out\"\n        })]\n      }) : /*#__PURE__*/_jsxs(_Fragment, {\n        children: [/*#__PURE__*/_jsx(Link, {\n          href: \"/login\",\n          children: /*#__PURE__*/_jsx(\"a\", {\n            className: \"w-20 py-1 mr-5 leading-5 lg:w-32 hollow blue button\",\n            children: \"log in\"\n          })\n        }), /*#__PURE__*/_jsx(Link, {\n          href: \"/register\",\n          children: /*#__PURE__*/_jsx(\"a\", {\n            className: \"w-20 py-1 leading-5 lg:w-32 blue button\",\n            children: \"sign up\"\n          })\n        })]\n      }))\n    })]\n  });\n};\n\nexport default Navbar;","map":null,"metadata":{},"sourceType":"module"}