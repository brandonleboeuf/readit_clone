{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/bleb/DEV/personal/projects for CODE page/readit_clone/client/src/pages/r/[sub]/[identifier]/[slug].tsx\";\nimport Head from 'next/head';\nimport Link from 'next/link';\nimport Image from 'next/image';\nimport { useRouter } from 'next/router';\nimport useSWR from 'swr';\nimport Axios from 'axios';\nimport classNames from 'classnames';\nimport dayjs from 'dayjs';\nimport relativeTime from 'dayjs/plugin/relativeTime';\nimport Sidebar from '../../../../components/Sidebar';\nimport { useAuthState } from '../../../../context/auth';\nimport ActionButton from '../../../../components/ActionButton';\nimport { useEffect, useState } from 'react';\ndayjs.extend(relativeTime);\nexport default function PostPage({}) {\n  // Local State\n  const {\n    0: newComment,\n    1: setNewComment\n  } = useState('');\n  const {\n    0: description,\n    1: setDescription\n  } = useState(''); // Global State\n\n  const {\n    authenticated,\n    user\n  } = useAuthState(); // Utils\n\n  const router = useRouter();\n  const {\n    identifier,\n    sub,\n    slug\n  } = router.query;\n  const {\n    data: post,\n    error,\n    revalidate: revaltwo\n  } = useSWR(identifier && slug ? `/posts/${identifier}/${slug}` : null);\n  const {\n    data: comments,\n    revalidate\n  } = useSWR(identifier && slug ? `/posts/${identifier}/${slug}/comments` : null);\n  if (error) router.push('/');\n  useEffect(() => {\n    if (!post) return;\n    let desc = post.body || post.title;\n    desc = desc.substring(0, 158).concat('..');\n    setDescription(desc);\n  }, [post]);\n\n  const vote = async (value, comment) => {\n    // If not logged in, send to log in page\n    if (!authenticated) router.push('/login'); // if vote is the same as current vote, reset vote\n\n    if (!comment && value === post.userVote || comment && comment.userVote === value) value = 0;\n\n    try {\n      await Axios.post('/misc/vote', {\n        identifier,\n        slug,\n        commentIdentifier: comment === null || comment === void 0 ? void 0 : comment.identifier,\n        value\n      });\n      revalidate();\n      revaltwo();\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const submitComment = async event => {\n    event.preventDefault();\n    if (newComment.trim() === '') return;\n\n    try {\n      await Axios.post(`/posts/${post.identifier}/${post.slug}/comments`, {\n        body: newComment\n      });\n      setNewComment('');\n      revalidate();\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const deletePost = async () => {\n    if (!authenticated) return;\n    if (user.username !== post.username || user.username !== 'brandon') return;\n    await Axios.delete(`/posts/${post.identifier}`);\n    router.push('/');\n  };\n\n  const deleteComment = async comment => {\n    if (!authenticated) return;\n    if (user.username !== comment.username || user.username !== 'brandon') return;\n    await Axios.delete(`/posts/${post.identifier}/${post.slug}/comments/${comment.identifier}`);\n    revalidate();\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: [/*#__PURE__*/_jsxDEV(\"title\", {\n        children: post === null || post === void 0 ? void 0 : post.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        name: \"description\",\n        content: description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        property: \"og:description\",\n        content: description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        property: \"og:title\",\n        content: post === null || post === void 0 ? void 0 : post.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        property: \"twitter:description\",\n        content: description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        property: \"twitter:title\",\n        content: post === null || post === void 0 ? void 0 : post.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Link, {\n      href: `/r/${sub}`,\n      children: /*#__PURE__*/_jsxDEV(\"a\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center h-20 p-8 bg-blue-500 width-full\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"container flex\",\n            children: [post && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-8 h-8 mr-2 overflow-hidden rounded-full\",\n              children: /*#__PURE__*/_jsxDEV(Image, {\n                src: post.sub.imageUrl,\n                height: 8 * 16 / 4,\n                width: 8 * 16 / 4\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 124,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xl font-semibold text-white\",\n              children: [\"/r/\", sub]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 131,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container flex pt-5\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-160\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white rounded\",\n          children: post && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-shrink-0 w-10 py-2 text-center rounded-l\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-6 mx-auto text-gray-400 rounded curser-pointer hover:bg-gray-300 hover:text-red-500\",\n                  onClick: () => vote(1),\n                  children: /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: classNames('icon-arrow-up', {\n                      'text-red-500': post.userVote === 1\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 150,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 146,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs font-bold\",\n                  children: post.voteScore\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 156,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-6 mx-auto text-gray-400 rounded curser-pointer hover:bg-gray-300 hover:text-blue-600\",\n                  onClick: () => vote(-1),\n                  children: /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: classNames('icon-arrow-down', {\n                      'text-blue-600': post.userVote === -1\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 162,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 158,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 144,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"py-2 pr-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center\",\n                  children: /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-xs text-gray-500\",\n                    children: [\"Posted by\", /*#__PURE__*/_jsxDEV(Link, {\n                      href: `/u/${post.username}`,\n                      children: /*#__PURE__*/_jsxDEV(\"a\", {\n                        className: \"mx-1 hover:underline\",\n                        children: [\"/u/\", post.username]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 174,\n                        columnNumber: 27\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 173,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Link, {\n                      href: post.url,\n                      children: /*#__PURE__*/_jsxDEV(\"a\", {\n                        className: \"mx-1 hover:underline\",\n                        children: dayjs(post.createdAt).fromNow()\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 179,\n                        columnNumber: 27\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 178,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 171,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 170,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n                  className: \"my-1 text-xl font-medium\",\n                  children: post.title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 186,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"my-3 text-sm\",\n                  children: post.body\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 188,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex\",\n                  children: [/*#__PURE__*/_jsxDEV(Link, {\n                    href: post.url,\n                    children: /*#__PURE__*/_jsxDEV(\"a\", {\n                      children: /*#__PURE__*/_jsxDEV(ActionButton, {\n                        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                          className: \"mr-1 fas fa-comment-alt fa-xs\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 194,\n                          columnNumber: 29\n                        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"font-bold\",\n                          children: [post.commentCount, \" comments\"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 195,\n                          columnNumber: 29\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 193,\n                        columnNumber: 27\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 192,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 191,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(ActionButton, {\n                    children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                      className: \"mr-1 fas fa-share fa-xs\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 202,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"font-bold\",\n                      children: \"share\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 203,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 201,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(ActionButton, {\n                    children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                      className: \"mr-1 fas fa-bookmark fa-xs\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 206,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"font-bold\",\n                      children: \"save\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 207,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 205,\n                    columnNumber: 23\n                  }, this), ((user === null || user === void 0 ? void 0 : user.username) === post.username || (user === null || user === void 0 ? void 0 : user.username) === 'brandon') && /*#__PURE__*/_jsxDEV(\"div\", {\n                    onClick: deletePost,\n                    children: /*#__PURE__*/_jsxDEV(ActionButton, {\n                      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                        className: \"mr-1 fas fa-trash fa-xs\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 213,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"font-bold\",\n                        children: \"delete\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 214,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 212,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 211,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 190,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pl-10 pr-6 mb-4\",\n              children: authenticated ? /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"mb-1 text-xs\",\n                  children: [\"Comment as\", ' ', /*#__PURE__*/_jsxDEV(Link, {\n                    href: `/u/${user.username}`,\n                    children: /*#__PURE__*/_jsxDEV(\"a\", {\n                      className: \"font-semibold text-blue-500\",\n                      children: user.username\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 228,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 227,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 225,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n                  onSubmit: submitComment,\n                  children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                    className: \"w-full p-3 border border-gray-300 rounded focus:outline-none focus:border-gray-600\",\n                    onChange: e => setNewComment(e.target.value),\n                    value: newComment\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 234,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex justify-end\",\n                    children: /*#__PURE__*/_jsxDEV(\"button\", {\n                      className: \"px-3 py-1 blue button\",\n                      disabled: newComment.trim() === '',\n                      children: \"Comment\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 240,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 239,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 233,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 224,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between px-2 py-4 border border-gray-200 rounded\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"font-semibold text-gray-400\",\n                  children: \"Log in or sign up to leave a comment\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 251,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(Link, {\n                    href: \"/login\",\n                    children: /*#__PURE__*/_jsxDEV(\"a\", {\n                      className: \"px-4 py-2 mr-4 hollow blue button\",\n                      children: \"Login\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 256,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 255,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Link, {\n                    href: \"/register\",\n                    children: /*#__PURE__*/_jsxDEV(\"a\", {\n                      className: \"px-4 py-2 blue button\",\n                      children: \"Sign up\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 261,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 260,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 254,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 250,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 222,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n              className: \"my-5 ml-10 mr-6\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 17\n            }, this), comments === null || comments === void 0 ? void 0 : comments.map(comment => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-shrink-0 w-10 py-2 text-center rounded-l\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-6 mx-auto text-gray-400 rounded curser-pointer hover:bg-gray-300 hover:text-red-500\",\n                  onClick: () => vote(1, comment),\n                  children: /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: classNames('icon-arrow-up', {\n                      'text-red-500': comment.userVote === 1\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 278,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 274,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs font-bold\",\n                  children: comment.voteScore\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 284,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-6 mx-auto text-gray-400 rounded curser-pointer hover:bg-gray-300 hover:text-blue-600\",\n                  onClick: () => vote(-1, comment),\n                  children: /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: classNames('icon-arrow-down', {\n                      'text-blue-600': comment.userVote === -1\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 290,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 286,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 272,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"py-2 pr-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"mb-1 text-xs leading-none\",\n                  children: [/*#__PURE__*/_jsxDEV(Link, {\n                    href: `/u/${comment.username}`,\n                    children: /*#__PURE__*/_jsxDEV(\"a\", {\n                      className: \"mr-1 font-bold hover:underline\",\n                      children: comment.username\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 300,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 299,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-600\",\n                    children: `\n                            ${comment.voteScore}\n                            points •\n                            ${dayjs(comment.createdAt).fromNow()}\n                          `\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 304,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 298,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: comment.body\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 312,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 297,\n                columnNumber: 21\n              }, this), ((user === null || user === void 0 ? void 0 : user.username) === post.username || (user === null || user === void 0 ? void 0 : user.username) === 'brandon') && /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: () => deleteComment(comment) // style={{ padding: '2px 0 0 0', margin: 0 }}\n                ,\n                children: /*#__PURE__*/_jsxDEV(ActionButton, {\n                  children: /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"fas fa-trash fa-xs\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 321,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 320,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 316,\n                columnNumber: 23\n              }, this)]\n            }, comment.identifier, true, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 19\n            }, this))]\n          }, void 0, true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 9\n      }, this), post && /*#__PURE__*/_jsxDEV(Sidebar, {\n        sub: post.sub\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 18\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}","map":{"version":3,"sources":["/Users/bleb/DEV/personal/projects for CODE page/readit_clone/client/src/pages/r/[sub]/[identifier]/[slug].tsx"],"names":["Head","Link","Image","useRouter","useSWR","Axios","classNames","dayjs","relativeTime","Sidebar","useAuthState","ActionButton","useEffect","useState","extend","PostPage","newComment","setNewComment","description","setDescription","authenticated","user","router","identifier","sub","slug","query","data","post","error","revalidate","revaltwo","comments","push","desc","body","title","substring","concat","vote","value","comment","userVote","commentIdentifier","err","console","log","submitComment","event","preventDefault","trim","deletePost","username","delete","deleteComment","imageUrl","voteScore","url","createdAt","fromNow","commentCount","e","target","map"],"mappings":"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","sourcesContent":["import Head from 'next/head'\nimport Link from 'next/link'\nimport Image from 'next/image'\nimport { useRouter } from 'next/router'\nimport useSWR from 'swr'\nimport Axios from 'axios'\nimport classNames from 'classnames'\nimport dayjs from 'dayjs'\nimport relativeTime from 'dayjs/plugin/relativeTime'\n\nimport { Post, Comment } from '../../../../types'\nimport Sidebar from '../../../../components/Sidebar'\nimport { useAuthState } from '../../../../context/auth'\nimport ActionButton from '../../../../components/ActionButton'\nimport { FormEvent, useEffect, useState } from 'react'\n\ndayjs.extend(relativeTime)\n\nexport default function PostPage({}) {\n  // Local State\n  const [newComment, setNewComment] = useState('')\n  const [description, setDescription] = useState('')\n\n  // Global State\n  const { authenticated, user } = useAuthState()\n\n  // Utils\n\n  const router = useRouter()\n\n  const { identifier, sub, slug } = router.query\n\n  const { data: post, error, revalidate: revaltwo } = useSWR<Post>(\n    identifier && slug ? `/posts/${identifier}/${slug}` : null\n  )\n\n  const { data: comments, revalidate } = useSWR<Comment[]>(\n    identifier && slug ? `/posts/${identifier}/${slug}/comments` : null\n  )\n\n  if (error) router.push('/')\n\n  useEffect(() => {\n    if (!post) return\n    let desc = post.body || post.title\n    desc = desc.substring(0, 158).concat('..')\n    setDescription(desc)\n  }, [post])\n\n  const vote = async (value: number, comment?: Comment) => {\n    // If not logged in, send to log in page\n    if (!authenticated) router.push('/login')\n\n    // if vote is the same as current vote, reset vote\n    if (\n      (!comment && value === post.userVote) ||\n      (comment && comment.userVote === value)\n    )\n      value = 0\n\n    try {\n      await Axios.post('/misc/vote', {\n        identifier,\n        slug,\n        commentIdentifier: comment?.identifier,\n        value,\n      })\n      revalidate()\n      revaltwo()\n    } catch (err) {\n      console.log(err)\n    }\n  }\n\n  const submitComment = async (event: FormEvent) => {\n    event.preventDefault()\n\n    if (newComment.trim() === '') return\n\n    try {\n      await Axios.post(`/posts/${post.identifier}/${post.slug}/comments`, {\n        body: newComment,\n      })\n\n      setNewComment('')\n      revalidate()\n    } catch (error) {\n      console.log(error)\n    }\n  }\n\n  const deletePost = async () => {\n    if (!authenticated) return\n    if (user.username !== post.username || user.username !== 'brandon') return\n    await Axios.delete(`/posts/${post.identifier}`)\n    router.push('/')\n  }\n  const deleteComment = async (comment: Comment) => {\n    if (!authenticated) return\n    if (user.username !== comment.username || user.username !== 'brandon')\n      return\n    await Axios.delete(\n      `/posts/${post.identifier}/${post.slug}/comments/${comment.identifier}`\n    )\n    revalidate()\n  }\n\n  return (\n    <>\n      <Head>\n        <title>{post?.title}</title>\n        <meta name=\"description\" content={description} />\n        <meta property=\"og:description\" content={description} />\n        <meta property=\"og:title\" content={post?.title} />\n        <meta property=\"twitter:description\" content={description} />\n        <meta property=\"twitter:title\" content={post?.title} />\n      </Head>\n      <Link href={`/r/${sub}`}>\n        <a>\n          <div className=\"flex items-center h-20 p-8 bg-blue-500 width-full\">\n            <div className=\"container flex\">\n              {post && (\n                <div className=\"w-8 h-8 mr-2 overflow-hidden rounded-full\">\n                  <Image\n                    src={post.sub.imageUrl}\n                    height={(8 * 16) / 4}\n                    width={(8 * 16) / 4}\n                  />\n                </div>\n              )}\n              <p className=\"text-xl font-semibold text-white\">/r/{sub}</p>\n            </div>\n          </div>\n        </a>\n      </Link>\n      <div className=\"container flex pt-5\">\n        {/* Post */}\n        <div className=\"w-160\">\n          <div className=\"bg-white rounded\">\n            {post && (\n              <>\n                <div className=\"flex\">\n                  {/* Vote section  */}\n                  <div className=\"flex-shrink-0 w-10 py-2 text-center rounded-l\">\n                    {/* Upvote */}\n                    <div\n                      className=\"w-6 mx-auto text-gray-400 rounded curser-pointer hover:bg-gray-300 hover:text-red-500\"\n                      onClick={() => vote(1)}\n                    >\n                      <i\n                        className={classNames('icon-arrow-up', {\n                          'text-red-500': post.userVote === 1,\n                        })}\n                      ></i>\n                    </div>\n                    <p className=\"text-xs font-bold\">{post.voteScore}</p>\n                    {/* Downvote */}\n                    <div\n                      className=\"w-6 mx-auto text-gray-400 rounded curser-pointer hover:bg-gray-300 hover:text-blue-600\"\n                      onClick={() => vote(-1)}\n                    >\n                      <i\n                        className={classNames('icon-arrow-down', {\n                          'text-blue-600': post.userVote === -1,\n                        })}\n                      ></i>\n                    </div>\n                  </div>\n                  <div className=\"py-2 pr-2\">\n                    <div className=\"flex items-center\">\n                      <p className=\"text-xs text-gray-500\">\n                        Posted by\n                        <Link href={`/u/${post.username}`}>\n                          <a className=\"mx-1 hover:underline\">\n                            /u/{post.username}\n                          </a>\n                        </Link>\n                        <Link href={post.url}>\n                          <a className=\"mx-1 hover:underline\">\n                            {dayjs(post.createdAt).fromNow()}\n                          </a>\n                        </Link>\n                      </p>\n                    </div>\n                    {/* Post Title */}\n                    <h1 className=\"my-1 text-xl font-medium\">{post.title}</h1>\n                    {/* Post Body */}\n                    <p className=\"my-3 text-sm\">{post.body}</p>\n                    {/* Actions */}\n                    <div className=\"flex\">\n                      <Link href={post.url}>\n                        <a>\n                          <ActionButton>\n                            <i className=\"mr-1 fas fa-comment-alt fa-xs\"></i>\n                            <span className=\"font-bold\">\n                              {post.commentCount} comments\n                            </span>\n                          </ActionButton>\n                        </a>\n                      </Link>\n                      <ActionButton>\n                        <i className=\"mr-1 fas fa-share fa-xs\"></i>\n                        <span className=\"font-bold\">share</span>\n                      </ActionButton>\n                      <ActionButton>\n                        <i className=\"mr-1 fas fa-bookmark fa-xs\"></i>\n                        <span className=\"font-bold\">save</span>\n                      </ActionButton>\n                      {(user?.username === post.username ||\n                        user?.username === 'brandon') && (\n                        <div onClick={deletePost}>\n                          <ActionButton>\n                            <i className=\"mr-1 fas fa-trash fa-xs\"></i>\n                            <span className=\"font-bold\">delete</span>\n                          </ActionButton>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n                {/* Comment input area */}\n                <div className=\"pl-10 pr-6 mb-4\">\n                  {authenticated ? (\n                    <div>\n                      <p className=\"mb-1 text-xs\">\n                        Comment as{' '}\n                        <Link href={`/u/${user.username}`}>\n                          <a className=\"font-semibold text-blue-500\">\n                            {user.username}\n                          </a>\n                        </Link>\n                      </p>\n                      <form onSubmit={submitComment}>\n                        <textarea\n                          className=\"w-full p-3 border border-gray-300 rounded focus:outline-none focus:border-gray-600\"\n                          onChange={(e) => setNewComment(e.target.value)}\n                          value={newComment}\n                        ></textarea>\n                        <div className=\"flex justify-end\">\n                          <button\n                            className=\"px-3 py-1 blue button\"\n                            disabled={newComment.trim() === ''}\n                          >\n                            Comment\n                          </button>\n                        </div>\n                      </form>\n                    </div>\n                  ) : (\n                    <div className=\"flex items-center justify-between px-2 py-4 border border-gray-200 rounded\">\n                      <p className=\"font-semibold text-gray-400\">\n                        Log in or sign up to leave a comment\n                      </p>\n                      <div>\n                        <Link href=\"/login\">\n                          <a className=\"px-4 py-2 mr-4 hollow blue button\">\n                            Login\n                          </a>\n                        </Link>\n                        <Link href=\"/register\">\n                          <a className=\"px-4 py-2 blue button\">Sign up</a>\n                        </Link>\n                      </div>\n                    </div>\n                  )}\n                </div>\n                <hr className=\"my-5 ml-10 mr-6\" />\n                {/* Comments feed */}\n                {comments?.map((comment) => (\n                  <div className=\"flex\" key={comment.identifier}>\n                    {/* Vote section  */}\n                    <div className=\"flex-shrink-0 w-10 py-2 text-center rounded-l\">\n                      {/* Upvote */}\n                      <div\n                        className=\"w-6 mx-auto text-gray-400 rounded curser-pointer hover:bg-gray-300 hover:text-red-500\"\n                        onClick={() => vote(1, comment)}\n                      >\n                        <i\n                          className={classNames('icon-arrow-up', {\n                            'text-red-500': comment.userVote === 1,\n                          })}\n                        ></i>\n                      </div>\n                      <p className=\"text-xs font-bold\">{comment.voteScore}</p>\n                      {/* Downvote */}\n                      <div\n                        className=\"w-6 mx-auto text-gray-400 rounded curser-pointer hover:bg-gray-300 hover:text-blue-600\"\n                        onClick={() => vote(-1, comment)}\n                      >\n                        <i\n                          className={classNames('icon-arrow-down', {\n                            'text-blue-600': comment.userVote === -1,\n                          })}\n                        ></i>\n                      </div>\n                    </div>\n                    <div className=\"py-2 pr-2\">\n                      <p className=\"mb-1 text-xs leading-none\">\n                        <Link href={`/u/${comment.username}`}>\n                          <a className=\"mr-1 font-bold hover:underline\">\n                            {comment.username}\n                          </a>\n                        </Link>\n                        <span className=\"text-gray-600\">\n                          {`\n                            ${comment.voteScore}\n                            points •\n                            ${dayjs(comment.createdAt).fromNow()}\n                          `}\n                        </span>\n                      </p>\n                      <p>{comment.body}</p>\n                    </div>\n                    {(user?.username === post.username ||\n                      user?.username === 'brandon') && (\n                      <div\n                        onClick={() => deleteComment(comment)}\n                        // style={{ padding: '2px 0 0 0', margin: 0 }}\n                      >\n                        <ActionButton>\n                          <i className=\"fas fa-trash fa-xs\"></i>\n                          {/* <span className=\"font-bold\">delete</span> */}\n                        </ActionButton>\n                      </div>\n                    )}\n                  </div>\n                ))}\n              </>\n            )}\n          </div>\n        </div>\n        {/* Sidebar */}\n        {post && <Sidebar sub={post.sub} />}\n      </div>\n    </>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}