{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/Users/bleb/DEV/personal/projects for CODE page/readit_clone/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/bleb/DEV/personal/projects for CODE page/readit_clone/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport Link from 'next/link';\nimport dayjs from 'dayjs';\nimport classNames from 'classnames';\nimport relativeTime from 'dayjs/plugin/relativeTime';\nimport Axios from 'axios';\nimport ActionButton from './ActionButton';\nimport { useAuthState } from '../context/auth';\nimport { useRouter } from 'next/router';\ndayjs.extend(relativeTime);\nexport default function PostCard(_ref) {\n  var _ref$post = _ref.post,\n      identifier = _ref$post.identifier,\n      slug = _ref$post.slug,\n      title = _ref$post.title,\n      body = _ref$post.body,\n      subName = _ref$post.subName,\n      createdAt = _ref$post.createdAt,\n      voteScore = _ref$post.voteScore,\n      userVote = _ref$post.userVote,\n      commentCount = _ref$post.commentCount,\n      url = _ref$post.url,\n      username = _ref$post.username,\n      sub = _ref$post.sub,\n      revalidate = _ref.revalidate;\n\n  var _useAuthState = useAuthState(),\n      authenticated = _useAuthState.authenticated;\n\n  var router = useRouter();\n\n  var vote = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              // If not logged in, send to log in page\n              if (!authenticated) router.push('/login'); // allows user to remove vote selection\n\n              if (value === userVote) value = 0;\n              _context.prev = 2;\n              _context.next = 5;\n              return Axios.post('/misc/vote', {\n                identifier: identifier,\n                slug: slug,\n                value: value\n              });\n\n            case 5:\n              res = _context.sent;\n              // revalidates when user votes\n              if (revalidate) revalidate();\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](2);\n              console.log(_context.t0);\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 9]]);\n    }));\n\n    return function vote(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: \"flex mb-4 bg-white rounded\",\n    id: identifier,\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"w-10 py-3 text-center bg-gray-200 rounded-l\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"w-6 mx-auto text-gray-400 rounded cursor-pointer hover:bg-gray-300 hover:text-red-500\",\n        onClick: function onClick() {\n          return vote(1);\n        },\n        children: /*#__PURE__*/_jsx(\"i\", {\n          className: classNames('icon-arrow-up', {\n            'text-red-500': userVote === 1\n          })\n        })\n      }), /*#__PURE__*/_jsx(\"p\", {\n        className: \"text-xs font-bold\",\n        children: voteScore\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"w-6 mx-auto text-gray-400 rounded cursor-pointer hover:bg-gray-300 hover:text-blue-600\",\n        onClick: function onClick() {\n          return vote(-1);\n        },\n        children: /*#__PURE__*/_jsx(\"i\", {\n          className: classNames('icon-arrow-down', {\n            'text-blue-600': userVote === -1\n          })\n        })\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"w-full p-2\",\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex items-center\",\n        children: [sub ? /*#__PURE__*/_jsxs(_Fragment, {\n          children: [/*#__PURE__*/_jsx(Link, {\n            href: \"/r/\".concat(subName),\n            children: /*#__PURE__*/_jsx(\"img\", {\n              src: sub.imageUrl // src=\"https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp&f=y\"\n              ,\n              className: \"w-6 h-6 mr-1 rounded-full cursor-pointer\"\n            })\n          }), /*#__PURE__*/_jsx(Link, {\n            href: \"/r/\".concat(subName),\n            children: /*#__PURE__*/_jsxs(\"a\", {\n              className: \"text-xs font-bold cursor-pointer hover:underline\",\n              children: [\"/r/\", subName]\n            })\n          }), /*#__PURE__*/_jsx(\"span\", {\n            className: \"mx-1 text-xs text-gray-500\",\n            children: \"\\u2022\"\n          })]\n        }) : null, /*#__PURE__*/_jsxs(\"p\", {\n          className: \"text-xs text-gray-500\",\n          children: [\"Posted by\", /*#__PURE__*/_jsx(Link, {\n            href: \"/u/\".concat(username),\n            children: /*#__PURE__*/_jsxs(\"a\", {\n              className: \"mx-1 hover:underline\",\n              children: [\"/u/\", username]\n            })\n          }), /*#__PURE__*/_jsx(Link, {\n            href: url,\n            children: /*#__PURE__*/_jsx(\"a\", {\n              className: \"mx-1 hover:underline\",\n              children: dayjs(createdAt).fromNow()\n            })\n          })]\n        })]\n      }), /*#__PURE__*/_jsx(Link, {\n        href: url,\n        children: /*#__PURE__*/_jsx(\"a\", {\n          className: \"my-1 text-lg font-medium\",\n          children: title\n        })\n      }), body && /*#__PURE__*/_jsx(\"p\", {\n        className: \"my-1 overflow-hidden text-sm\",\n        style: {\n          maxHeight: '90px'\n        },\n        children: body\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"flex\",\n        children: [/*#__PURE__*/_jsx(Link, {\n          href: url,\n          children: /*#__PURE__*/_jsx(\"a\", {\n            children: /*#__PURE__*/_jsxs(ActionButton, {\n              children: [/*#__PURE__*/_jsx(\"i\", {\n                className: \"mr-1 fas fa-comment-alt fa-xs\"\n              }), /*#__PURE__*/_jsxs(\"span\", {\n                className: \"font-bold\",\n                children: [commentCount, \" comments\"]\n              })]\n            })\n          })\n        }), /*#__PURE__*/_jsxs(ActionButton, {\n          children: [/*#__PURE__*/_jsx(\"i\", {\n            className: \"mr-1 fas fa-share fa-xs\"\n          }), /*#__PURE__*/_jsx(\"span\", {\n            className: \"font-bold\",\n            children: \"share\"\n          })]\n        }), /*#__PURE__*/_jsxs(ActionButton, {\n          children: [/*#__PURE__*/_jsx(\"i\", {\n            className: \"mr-1 fas fa-bookmark fa-xs\"\n          }), /*#__PURE__*/_jsx(\"span\", {\n            className: \"font-bold\",\n            children: \"save\"\n          })]\n        })]\n      })]\n    })]\n  }, identifier);\n}","map":null,"metadata":{},"sourceType":"module"}